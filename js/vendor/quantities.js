(function(f,r){"object"===typeof exports?module.exports=r():"function"===typeof define&&define.amd?define(r):f.Qty=r()})(this,function(){function f(a){this.signature=this.base_scalar=this.scalar=null;this.output={};this.denominator=this.numerator=h;this._units=null;this.init_value=a;if(a.constructor===String){var b=I.exec(a);if(!b)throw a+": Quantity not recognized";if(""===a.trim())throw"Unit not recognized";this.scalar=b[1]?parseFloat(b[1]):1;a=b[2];for(var c=b[3],d,e,g;b=J.exec(a);){d=parseFloat(b[2]);
e=b[1]+" ";g="";for(var f=0;f<Math.abs(d);f++)g+=e;0<=d?a=a.replace(RegExp(b[1]+x+d),g):(c=c?c+g:g,a=a.replace(RegExp(b[1]+x+d),""))}for(;b=A.exec(c);){d=parseFloat(b[2]);e=b[1]+" ";g="";for(b=0;b<d;b++)g+=e;c=c.replace(A,g,"g")}if(a){if(!B.test(a))throw"Unit not recognized";for(this.numerator=[];b=C.exec(a);)this.numerator.push(b.slice(1))}if(c){if(!B.test(c))throw"Unit not recognized";for(this.denominator=[];b=C.exec(c);)this.denominator.push(b.slice(1))}this.numerator=this.numerator.map(function(a){return s[a[0]]?
[s[a[0]],t[a[1]]]:[t[a[1]]]});this.numerator=this.numerator.reduce(function(a,b){return a.concat(b)},[]);this.numerator=this.numerator.filter(function(a){return a});this.denominator=this.denominator.map(function(a){return s[a[0]]?[s[a[0]],t[a[1]]]:[t[a[1]]]});this.denominator=this.denominator.reduce(function(a,b){return a.concat(b)},[]);this.denominator=this.denominator.filter(function(a){return a});0===this.numerator.length&&(this.numerator=h);0===this.denominator.length&&(this.denominator=h)}else this.scalar=
a.scalar,this.numerator=a.numerator&&0!==a.numerator.length?a.numerator:h,this.denominator=a.denominator&&0!==a.denominator.length?a.denominator:h;if(!this.base_scalar)if(this.isBase()){this.base_scalar=this.scalar;if(this.signature)a=this.signature;else{a=r.call(this);for(c=0;c<a.length;c++)a[c]*=Math.pow(20,c);a=a.reduce(function(a,b){return a+b},0)}this.signature=a}else a=this.toBase(),this.base_scalar=a.scalar,this.signature=a.signature}function r(){if(!this.isBase())return r.call(this.toBase());
for(var a=Array(y.length),b=0;b<a.length;b++)a[b]=0;for(var c=0;c<this.numerator.length;c++)if(b=v[this.numerator[c]])b=y.indexOf(b[2]),0<=b&&(a[b]+=1);for(c=0;c<this.denominator.length;c++)if(b=v[this.denominator[c]])b=y.indexOf(b[2]),0<=b&&(a[b]-=1);return a}function D(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c);return b}function E(a){return 1===a.length?a:a.reduce(function(a,c){a.some(function(a){return m(a,c)})||a.push(c);return a},[])}function m(a,b){if(b.length!==a.length)return!1;
for(var c=0;c<a.length;c++)if(b[c].compareArray&&!b[c].compareArray(a[c])||b[c]!==a[c])return!1;return!0}function z(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}function w(){for(var a,b,c=1,d=0;d<arguments.length;d++){var e=arguments[d],g;b=void 0;if((g=K.exec(e))&&g[2])b=g[2].length;else if(g=L.exec(e))b=parseInt(g[2],10);b&&(a=(a||0)+b);c*=e}return a?z(c,a):c}function F(a,b){return w(a,1/b)}function G(a,b){a=a.filter(function(a){return a!==u});b=b.filter(function(a){return a!==u});for(var c=
{},d,e=0;e<a.length;e++)n[a[e]]?(d=[a[e],a[e+1]],e++):d=a[e],d&&d!==u&&(c[d]?c[d][0]++:c[d]=[1,d]);for(e=0;e<b.length;e++)n[b[e]]?(d=[b[e],b[e+1]],e++):d=b[e],d&&d!==u&&(c[d]?c[d][0]--:c[d]=[-1,d]);a=[];b=[];for(var g in c)if(c.hasOwnProperty(g))if(d=c[g],0<d[0])for(e=0;e<d[0];e++)a.push(d[1]);else if(0>d[0])for(e=0;e<-d[0];e++)b.push(d[1]);0===a.length&&(a=h);0===b.length&&(b=h);a=a.reduce(function(a,b){return a.concat(b)},[]);b=b.reduce(function(a,b){return a.concat(b)},[]);return[a,b]}var v={"<googol>":[["googol"],
1E100,"prefix"],"<kibi>":[["Ki","Kibi","kibi"],Math.pow(2,10),"prefix"],"<mebi>":[["Mi","Mebi","mebi"],Math.pow(2,20),"prefix"],"<gibi>":[["Gi","Gibi","gibi"],Math.pow(2,30),"prefix"],"<tebi>":[["Ti","Tebi","tebi"],Math.pow(2,40),"prefix"],"<pebi>":[["Pi","Pebi","pebi"],Math.pow(2,50),"prefix"],"<exi>":[["Ei","Exi","exi"],Math.pow(2,60),"prefix"],"<zebi>":[["Zi","Zebi","zebi"],Math.pow(2,70),"prefix"],"<yebi>":[["Yi","Yebi","yebi"],Math.pow(2,80),"prefix"],"<yotta>":[["Y","Yotta","yotta"],1E24,"prefix"],
"<zetta>":[["Z","Zetta","zetta"],1E21,"prefix"],"<exa>":[["E","Exa","exa"],1E18,"prefix"],"<peta>":[["P","Peta","peta"],1E15,"prefix"],"<tera>":[["T","Tera","tera"],1E12,"prefix"],"<giga>":[["G","Giga","giga"],1E9,"prefix"],"<mega>":[["M","Mega","mega"],1E6,"prefix"],"<kilo>":[["k","kilo"],1E3,"prefix"],"<hecto>":[["h","Hecto","hecto"],100,"prefix"],"<deca>":[["da","Deca","deca","deka"],10,"prefix"],"<deci>":[["d","Deci","deci"],0.1,"prefix"],"<centi>":[["c","Centi","centi"],0.01,"prefix"],"<milli>":[["m",
"Milli","milli"],0.001,"prefix"],"<micro>":[["u","Micro","micro"],1E-6,"prefix"],"<nano>":[["n","Nano","nano"],1E-9,"prefix"],"<pico>":[["p","Pico","pico"],1E-12,"prefix"],"<femto>":[["f","Femto","femto"],1E-15,"prefix"],"<atto>":[["a","Atto","atto"],1E-18,"prefix"],"<zepto>":[["z","Zepto","zepto"],1E-21,"prefix"],"<yocto>":[["y","Yocto","yocto"],1E-24,"prefix"],"<1>":[["1","<1>"],1,""],"<meter>":[["m","meter","meters","metre","metres"],1,"length",["<meter>"]],"<inch>":[["in","inch","inches",'"'],
0.0254,"length",["<meter>"]],"<foot>":[["ft","foot","feet","'"],0.3048,"length",["<meter>"]],"<yard>":[["yd","yard","yards"],0.9144,"length",["<meter>"]],"<mile>":[["mi","mile","miles"],1609.344,"length",["<meter>"]],"<naut-mile>":[["nmi"],1852,"length",["<meter>"]],"<league>":[["league","leagues"],4828,"length",["<meter>"]],"<furlong>":[["furlong","furlongs"],201.2,"length",["<meter>"]],"<rod>":[["rd","rod","rods"],5.029,"length",["<meter>"]],"<mil>":[["mil","mils"],2.54E-5,"length",["<meter>"]],
"<angstrom>":[["ang","angstrom","angstroms"],1E-10,"length",["<meter>"]],"<fathom>":[["fathom","fathoms"],1.829,"length",["<meter>"]],"<pica>":[["pica","picas"],0.004217,"length",["<meter>"]],"<point>":[["pt","point","points"],3.514E-4,"length",["<meter>"]],"<kilogram>":[["kg","kilogram","kilograms"],1,"mass",["<kilogram>"]],"<AMU>":[["u","AMU","amu"],6.0221415E26,"mass",["<kilogram>"]],"<dalton>":[["Da","Dalton","Daltons","dalton","daltons"],6.0221415E26,"mass",["<kilogram>"]],"<slug>":[["slug",
"slugs"],14.5939029,"mass",["<kilogram>"]],"<short-ton>":[["tn","ton"],907.18474,"mass",["<kilogram>"]],"<metric-ton>":[["tonne"],1E3,"mass",["<kilogram>"]],"<carat>":[["ct","carat","carats"],2E-4,"mass",["<kilogram>"]],"<pound>":[["lbs","lb","pound","pounds","#"],0.45359237,"mass",["<kilogram>"]],"<ounce>":[["oz","ounce","ounces"],0.0283495231,"mass",["<kilogram>"]],"<gram>":[["g","gram","grams","gramme","grammes"],0.001,"mass",["<kilogram>"]],"<hectare>":[["hectare"],1E4,"area",["<meter>","<meter>"]],
"<acre>":[["acre","acres"],4046.85642,"area",["<meter>","<meter>"]],"<sqft>":[["sqft"],1,"area",["<feet>","<feet>"]],"<liter>":["l L liter liters litre litres".split(" "),0.001,"volume",["<meter>","<meter>","<meter>"]],"<gallon>":[["gal","gallon","gallons"],0.0037854118,"volume",["<meter>","<meter>","<meter>"]],"<quart>":[["qt","quart","quarts"],9.4635295E-4,"volume",["<meter>","<meter>","<meter>"]],"<pint>":[["pt","pint","pints"],4.73176475E-4,"volume",["<meter>","<meter>","<meter>"]],"<cup>":[["cu",
"cup","cups"],2.36588238E-4,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce>":[["floz","fluid-ounce"],2.95735297E-5,"volume",["<meter>","<meter>","<meter>"]],"<tablespoon>":[["tbs","tablespoon","tablespoons"],1.47867648E-5,"volume",["<meter>","<meter>","<meter>"]],"<teaspoon>":[["tsp","teaspoon","teaspoons"],4.92892161E-6,"volume",["<meter>","<meter>","<meter>"]],"<kph>":[["kph"],0.277777778,"speed",["<meter>"],["<second>"]],"<mph>":[["mph"],0.44704,"speed",["<meter>"],["<second>"]],"<knot>":[["kt",
"kn","kts","knot","knots"],0.514444444,"speed",["<meter>"],["<second>"]],"<fps>":[["fps"],0.3048,"speed",["<meter>"],["<second>"]],"<gee>":[["gee"],9.80655,"acceleration",["<meter>"],["<second>","<second>"]],"<kelvin>":[["degK","kelvin"],1,"temperature",["<kelvin>"]],"<celsius>":[["degC","celsius","celsius","centigrade"],1,"temperature",["<kelvin>"]],"<fahrenheit>":[["degF","fahrenheit"],1/1.8,"temperature",["<kelvin>"]],"<rankine>":[["degR","rankine"],1/1.8,"temperature",["<kelvin>"]],"<temp-K>":[["tempK"],
1,"temperature",["<temp-K>"]],"<temp-C>":[["tempC"],1,"temperature",["<temp-K>"]],"<temp-F>":[["tempF"],1/1.8,"temperature",["<temp-K>"]],"<temp-R>":[["tempR"],1/1.8,"temperature",["<temp-K>"]],"<second>":[["s","sec","second","seconds"],1,"time",["<second>"]],"<minute>":[["min","minute","minutes"],60,"time",["<second>"]],"<hour>":[["h","hr","hrs","hour","hours"],3600,"time",["<second>"]],"<day>":[["d","day","days"],86400,"time",["<second>"]],"<week>":[["wk","week","weeks"],604800,"time",["<second>"]],
"<fortnight>":[["fortnight","fortnights"],1209600,"time",["<second>"]],"<year>":[["y","yr","year","years","annum"],31556926,"time",["<second>"]],"<decade>":[["decade","decades"],315569260,"time",["<second>"]],"<century>":[["century","centuries"],3155692600,"time",["<second>"]],"<pascal>":[["Pa","pascal","Pascal"],1,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<bar>":[["bar","bars"],1E5,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<mmHg>":[["mmHg"],133.322368,"pressure",
["<kilogram>"],["<meter>","<second>","<second>"]],"<inHg>":[["inHg"],3386.3881472,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<torr>":[["torr"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<atm>":[["atm","ATM","atmosphere","atmospheres"],101325,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<psi>":[["psi"],6894.76,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<cmh2o>":[["cmH2O"],98.0638,"pressure",["<kilogram>"],["<meter>",
"<second>","<second>"]],"<inh2o>":[["inH2O"],249.082052,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<poise>":[["P","poise"],0.1,"viscosity",["<kilogram>"],["<meter>","<second>"]],"<stokes>":[["St","stokes"],1E-4,"viscosity",["<meter>","<meter>"],["<second>"]],"<mole>":[["mol","mole"],1,"substance",["<mole>"]],"<molar>":[["M","molar"],1E3,"concentration",["<mole>"],["<meter>","<meter>","<meter>"]],"<wtpercent>":[["wt%","wtpercent"],10,"concentration",["<kilogram>"],["<meter>","<meter>",
"<meter>"]],"<katal>":[["kat","katal","Katal"],1,"activity",["<mole>"],["<second>"]],"<unit>":[["U","enzUnit"],1.6667E-15,"activity",["<mole>"],["<second>"]],"<farad>":[["F","farad","Farad"],1,"capacitance",["<farad>"]],"<coulomb>":[["C","coulomb","Coulomb"],1,"charge",["<ampere>","<second>"]],"<ampere>":[["A","Ampere","ampere","amp","amps"],1,"current",["<ampere>"]],"<siemens>":[["S","Siemens","siemens"],1,"resistance",["<second>","<second>","<second>","<ampere>","<ampere>"],["<kilogram>","<meter>",
"<meter>"]],"<henry>":[["H","Henry","henry"],1,"inductance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>","<ampere>"]],"<volt>":[["V","Volt","volt","volts"],1,"potential",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>"]],"<ohm>":[["Ohm","ohm"],1,"resistance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>","<ampere>"]],"<weber>":[["Wb","weber","webers"],1,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>",
"<second>","<ampere>"]],"<tesla>":[["T","tesla","teslas"],1,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<gauss>":[["G","gauss"],1E-4,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<maxwell>":[["Mx","maxwell","maxwells"],1E-8,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<oersted>":[["Oe","oersted","oersteds"],250/Math.PI,"magnetism",["<ampere>"],["<meter>"]],"<joule>":[["J","joule","Joule","joules"],1,"energy",["<meter>","<meter>",
"<kilogram>"],["<second>","<second>"]],"<erg>":[["erg","ergs"],1E-7,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<btu>":[["BTU","btu","BTUs"],1055.056,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<calorie>":[["cal","calorie","calories"],4.184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Calorie>":[["Cal","Calorie","Calories"],4184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<therm-US>":[["th","therm",
"therms","Therm"],105480400,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<newton>":[["N","Newton","newton"],1,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<dyne>":[["dyn","dyne"],1E-5,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<pound-force>":[["lbf","pound-force"],4.448222,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<hertz>":[["Hz","hertz","Hertz"],1,"frequency",["<1>"],["<second>"]],"<radian>":[["rad","radian","radian"],1,"angle",
["<radian>"]],"<degree>":[["deg","degree","degrees"],Math.PI/180,"angle",["<radian>"]],"<grad>":[["grad","gradian","grads"],Math.PI/200,"angle",["<radian>"]],"<steradian>":[["sr","steradian","steradians"],1,"solid_angle",["<steradian>"]],"<rotation>":[["rotation"],2*Math.PI,"angle",["<radian>"]],"<rpm>":[["rpm"],2*Math.PI/60,"angular_velocity",["<radian>"],["<second>"]],"<byte>":[["B","byte"],1,"memory",["<byte>"]],"<bit>":[["b","bit"],0.125,"memory",["<byte>"]],"<dollar>":[["USD","dollar"],1,"currency",
["<dollar>"]],"<cents>":[["cents"],0.01,"currency",["<dollar>"]],"<candela>":[["cd","candela"],1,"luminosity",["<candela>"]],"<lumen>":[["lm","lumen"],1,"luminous_power",["<candela>","<steradian>"]],"<lux>":[["lux"],1,"illuminance",["<candela>","<steradian>"],["<meter>","<meter>"]],"<watt>":[["W","watt","watts"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<horsepower>":[["hp","horsepower"],745.699872,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>",
"<second>"]],"<gray>":[["Gy","gray","grays"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<roentgen>":[["R","roentgen"],0.00933,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<sievert>":[["Sv","sievert","sieverts"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<becquerel>":[["Bq","bequerel","bequerels"],1,"radiation",["<1>"],["<second>"]],"<curie>":[["Ci","curie","curies"],37E9,"radiation",["<1>"],["<second>"]],"<cpm>":[["cpm"],1/60,"rate",["<count>"],
["<second>"]],"<dpm>":[["dpm"],1/60,"rate",["<count>"],["<second>"]],"<bpm>":[["bpm"],1/60,"rate",["<count>"],["<second>"]],"<dot>":[["dot","dots"],1,"resolution",["<each>"]],"<pixel>":[["pixel","px"],1,"resolution",["<each>"]],"<ppi>":[["ppi"],1,"resolution",["<pixel>"],["<inch>"]],"<dpi>":[["dpi"],1,"typography",["<dot>"],["<inch>"]],"<cell>":[["cells","cell"],1,"counting",["<each>"]],"<each>":[["each"],1,"counting",["<each>"]],"<count>":[["count"],1,"counting",["<each>"]],"<base-pair>":[["bp"],
1,"counting",["<each>"]],"<nucleotide>":[["nt"],1,"counting",["<each>"]],"<molecule>":[["molecule","molecules"],1,"counting",["<1>"]],"<dozen>":[["doz","dz","dozen"],12,"prefix_only",["<each>"]],"<percent>":[["%","percent"],0.01,"prefix_only",["<1>"]],"<ppm>":[["ppm"],1E-6,"prefix_only",["<1>"]],"<ppt>":[["ppt"],1E-9,"prefix_only",["<1>"]],"<gross>":[["gr","gross"],144,"prefix_only",["<dozen>","<dozen>"]],"<decibel>":[["dB","decibel","decibels"],1,"logarithmic",["<decibel>"]]},M="<meter> <kilogram> <second> <mole> <farad> <ampere> <radian> <kelvin> <temp-K> <byte> <dollar> <candela> <each> <steradian> <decibel>".split(" "),
u="<1>",h=[u],I=/([+-]?\d*[.]?\d+(?:[Ee][+-]?)?\d*)*\s*([^/]*)\/*(.+)*/,x="(?:\\^|\\*\\*)?",J=RegExp("([^ \\*]+?)"+x+"([\\d-]+)"),A=RegExp("([^ \\*]+?)"+x+"(\\d+)"),y="length time temperature mass current substance luminosity currency memory angle capacitance".split(" "),N={"-312058":"resistance","-312038":"inductance","-152040":"magnetism","-152038":"magnetism","-152058":"potential","-39":"acceleration","-38":"radiation","-20":"frequency","-19":"speed","-18":"viscosity","0":"unitless",1:"length",
2:"area",3:"volume",20:"time",400:"temperature",7942:"power",7959:"pressure",7962:"energy",7979:"viscosity",7981:"force",7997:"mass_concentration",8E3:"mass",159999:"magnetism",16E4:"current",160020:"charge",312058:"resistance",3199980:"activity",3199997:"molar_concentration",32E5:"substance",63999998:"illuminance",64E6:"luminous_power",128E7:"currency",256E8:"memory",511999999980:"angular_velocity",512E9:"angle",1024E10:"capacitance"},H={};f.prototype={toFloat:function(){if(this.isUnitless())return this.scalar;
throw"Can't convert to Float unless unitless.  Use Unit#scalar";},isUnitless:function(){return m(this.numerator,h)&&m(this.denominator,h)},isCompatible:function(a){return a&&a.constructor===String?this.isCompatible(new f(a)):!(a instanceof f)?!1:void 0!==a.signature?this.signature===a.signature:!1},kind:function(){return N[this.signature.toString()]},isBase:function(){if(void 0!==this.is_base)return this.is_base;if(400===this.signature&&1===this.numerator.length&&m(this.denominator,h)&&this.units.match(/(deg|temp)K/))return this.is_base=
!0;this.numerator.concat(this.denominator).forEach(function(a){a!==u&&!M.some(function(b){return b===a})&&(this.is_base=!1)},this);return!1===this.is_base?this.is_base:this.is_base=!0},toBase:function(){if(this.isBase())return this;var a=H[this.units()];if(a)return a.mul(this.scalar);for(var a=[],b=[],c=1,d,e=0;e<this.numerator.length;e++)d=this.numerator[e],n[d]?c=w(c,n[d]):j[d]&&(c*=j[d].scalar,j[d].numerator&&a.push(j[d].numerator),j[d].denominator&&b.push(j[d].denominator));for(e=0;e<this.denominator.length;e++)d=
this.denominator[e],n[d]?c/=n[d]:j[d]&&(c/=j[d].scalar,j[d].numerator&&b.push(j[d].numerator),j[d].denominator&&a.push(j[d].denominator));a=a.reduce(function(a,b){return a.concat(b)},[]);b=b.reduce(function(a,b){return a.concat(b)},[]);a=new f({scalar:c,numerator:a,denominator:b});H[this.units()]=a;return a.mul(this.scalar)},units:function(){if(m(this.numerator,h)&&m(this.denominator,h))return"";if(this._units)return this._units;var a=[],b=[],c,d;if(m(this.numerator,h))a=["1"];else for(var e=0;e<
this.numerator.length;e++)c=this.numerator[e],d=this.numerator[e+1],n[c]?(a.push(p[c]+p[d]),e++):a.push(p[c]);if(m(this.denominator,h))b=h;else for(e=0;e<this.denominator.length;e++)c=this.denominator[e],d=this.denominator[e+1],n[c]?(b.push(p[c]+p[d]),e++):b.push(p[c]);c=E(a.map(function(b){return[b,a.filter(function(a){return a===b}).length]})).map(function(a){return a[0]+(1<a[1]?a[1]:"")});d=E(b.map(function(a){return[a,b.filter(function(b){return b===a}).length]})).map(function(a){return a[0]+
(1<a[1]?a[1]:"")});return this._units=c.join("*")+(m(b,h)?"":"/"+d.join("*"))},eq:function(a){return 0===this.compareTo(a)},lt:function(a){return-1===this.compareTo(a)},lte:function(a){return this.eq(a)||this.lt(a)},gt:function(a){return 1===this.compareTo(a)},gte:function(a){return this.eq(a)||this.gt(a)},toPrec:function(a){a&&a.constructor===String&&(a=new f(a));a=a.to(this.units());var b=Math.round(this.scalar/a.scalar)*a.scalar;a=Math.floor(Math.log(Math.abs(a.scalar))/Math.LN10);b=z(b,-a);return new f(b+
this.units())},toString:function(a,b){var c;if("number"===typeof a)b=a;else if("string"===typeof a)c=a;else if(a instanceof f)return this.toPrec(a).toString(b);var d;!b&&this.output[c]?d=this.output[c]:c?(d=this.to(c),this.output[c]=d):d=this;return d=((void 0!==b?z(d.scalar,b):d.scalar)+" "+d.units()).trim()},compareTo:function(a){if(a&&a.constructor===String)return this.compareTo(new f(a));if(!this.isCompatible(a))throw"Incompatible quantities";if(this.base_scalar<a.base_scalar)return-1;if(this.base_scalar===
a.base_scalar)return 0;if(this.base_scalar>a.base_scalar)return 1},same:function(a){return this.scalar===a.scalar&&this.units()===a.units()},to:function(a){if(a&&a.constructor!==String)return this.to(a.units());a=new f(a);if(a.units()===this.units())return this;if(!this.isCompatible(a))throw"Incompatible Units";var b=F(this.base_scalar,a.base_scalar);return new f({scalar:b,numerator:a.numerator,denominator:a.denominator})},add:function(a){a&&a.constructor===String&&(a=new f(a));if(!this.isCompatible(a))throw"Incompatible Units";
return new f({scalar:this.scalar+a.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},sub:function(a){a&&a.constructor===String&&(a=new f(a));if(!this.isCompatible(a))throw"Incompatible Units";return new f({scalar:this.scalar-a.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},mul:function(a){if("number"===typeof a)return new f({scalar:w(this.scalar,a),numerator:this.numerator,denominator:this.denominator});a&&a.constructor===String&&(a=new f(a));var b=
this;b.isCompatible(a)?a=a.to(b):(b.isBase()||(b=b.toBase()),a.isBase()||(a=a.toBase()));var c=G(b.numerator.concat(a.numerator),b.denominator.concat(a.denominator));return new f({scalar:w(b.scalar,a.scalar),numerator:c[0],denominator:c[1]})},div:function(a){if("number"===typeof a){if(0===a)throw"Divide by zero";return new f({scalar:this.scalar/a,numerator:this.numerator,denominator:this.denominator})}a&&a.constructor===String&&(a=new f(a));if(0===a.scalar)throw"Divide by zero";var b=this;b.isCompatible(a)?
a=a.to(b):(b.isBase()||(b=b.toBase()),a.isBase()||(a=a.toBase()));var c=G(b.numerator.concat(a.denominator),b.denominator.concat(a.numerator));return new f({scalar:b.scalar/a.scalar,numerator:c[0],denominator:c[1]})}};var K=/^-?(\d+)(?:\.(\d+))?$/,L=/^-?(\d+)e-?(\d+)$/;f.mul_safe=w;f.div_safe=F;var n={},s={},j={},t={},p={},l;for(l in v)if(v.hasOwnProperty(l)){var k=v[l];if("prefix"===k[2]){n[l]=k[1];for(var q=0;q<k[0].length;q++)s[k[0][q]]=l}else{j[l]={scalar:k[1],numerator:k[3],denominator:k[4]};
for(q=0;q<k[0].length;q++)t[k[0][q]]=l}p[l]=k[0][0]}l=D(s).sort(function(a,b){return b.length-a.length}).join("|");var k=D(t).sort(function(a,b){return b.length-a.length}).join("|"),C=RegExp("("+l+")*?("+k+")\\b","g"),B=RegExp("^\\s*(("+l+")*?("+k+")\\s*\\*?\\s*)+$");return f});
